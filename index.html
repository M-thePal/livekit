<!doctype html>
<html>
  <head>
    <title>LiveKit Test</title>
    <script src="https://unpkg.com/livekit-client/dist/livekit-client.umd.min.js"></script>
  </head>
  <body>
    <h1>LiveKit Room</h1>
    <div id="videos"></div>
    <button onclick="connect()">Connect</button>

    <script>
      const LIVEKIT_URL = "ws://localhost:7880";
      const ACCESS_TOKEN =
        "eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiVXNlciIsInZpZGVvIjp7InJvb20iOiJteS1yb29tIiwicm9vbUpvaW4iOnRydWUsImNhblB1Ymxpc2giOnRydWUsImNhblN1YnNjcmliZSI6dHJ1ZSwiY2FuUHVibGlzaERhdGEiOnRydWV9LCJpc3MiOiJkZXZrZXkiLCJleHAiOjE3NjU3NDk0NzIsIm5iZiI6MCwic3ViIjoiVXNlciJ9.__w-r9OqIXNVYMCMO6MB6OdGmaIl8jYchvO_t3q6Cek"; // Paste your token here

      async function connect() {
        const room = new LivekitClient.Room();

        // Handle events
        room.on("trackSubscribed", (track, publication, participant) => {
          if (track.kind === "video") {
            const video = track.attach();
            document.getElementById("videos").appendChild(video);
          }
        });

        // Connect to room
        await room.connect(LIVEKIT_URL, ACCESS_TOKEN);
        console.log("Connected to room:", room.name);

        // Enable camera and microphone
        await room.localParticipant.enableCameraAndMicrophone();

        // Attach your local video
        const videoTrack = room.localParticipant.videoTracks
          .values()
          .next().value;
        if (videoTrack) {
          const video = videoTrack.track.attach();
          video.muted = true; // Mute your own audio to avoid feedback
          document.getElementById("videos").appendChild(video);
        }
      }
    </script>
  </body>
</html>
